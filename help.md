#  Java 水印工具开发流程（供本地终端 AI 助手使用）—— 含 Conventional Commits 规范

> **目标：** 开发一个 **Windows 平台本地运行的 Java 桌面应用程序**，支持为图片添加**文本/图片水印**，具备**图片批量导入、水印布局调整、导出设置、模板管理**等功能，最终打包为可执行程序。
>
> **开发要求：** 在代码版本管理上，使用 **Git** 进行管理，并**在每次提交时严格遵循 Conventional Commits 规范，以保证提交信息结构清晰、语义明确，便于构建自动化工具链与协作开发。**

------

## 🤖 什么是 Conventional Commits？

**Conventional Commits** 是一种轻量级约定，用于规范 Git 提交信息的格式，推荐格式如下：

```
<type>(<scope>): <subject>

<body>

<footer>
```

### 常用提交类型（type）包括：

| 类型         | 说明                                       |
| :----------- | :----------------------------------------- |
| **feat**     | 新增功能                                   |
| **fix**      | 修复 bug                                   |
| **docs**     | 文档变更                                   |
| **style**    | 代码格式（不影响逻辑，如空格、分号等）     |
| **refactor** | 代码重构（既不是新功能也不是修复 bug）     |
| **perf**     | 性能优化                                   |
| **test**     | 增加/修改测试                              |
| **chore**    | 构建过程或辅助工具的变动（如依赖、配置等） |
| **build**    | 影响构建系统或外部依赖项的更改             |
| **ci**       | 持续集成相关配置或脚本的变动               |

🔹 示例：

- `feat(watermark): 添加文本水印透明度支持`
- `fix(image): 修复 JPEG 导出时颜色失真问题`
- `chore(deps): 升级 JavaFX 依赖至 21`
- `docs(readme): 更新开发流程说明`

------

## ✅ 一、整体开发流程总纲（分阶段 + Conventional Commits）

| 阶段        | 目标                        | 关键任务                                               | 输出                                                    |
| :---------- | :-------------------------- | :----------------------------------------------------- | :------------------------------------------------------ |
| **阶段 1**  | 环境与工具准备 + Git 初始化 | 搭建 Java 开发环境，初始化 Git 仓库，约定 Commit 规范  | JDK + Maven/Gradle + JavaFX/Swing 项目初始化 + Git 仓库 |
| **阶段 2**  | 项目初始化与架构设计        | 创建 Maven 项目结构，定义模块划分，设计基础交互流程    | Maven 项目骨架 + 模块划分文档                           |
| **阶段 3**  | 图片导入模块                | 支持单张/多张/文件夹导入，显示缩略图与文件列表         | 图片加载、列表展示功能                                  |
| **阶段 4**  | 水印核心功能（文本）        | 实现文本水印的添加：内容、字体、颜色、透明度、位置     | 文本水印绘制逻辑                                        |
| **阶段 5**  | 水印布局与交互              | 支持水印位置（九宫格/拖拽）、旋转、预览                | 水印位置控制与实时预览                                  |
| **阶段 6**  | 图片导出模块                | 支持导出路径、格式选择（JPEG/PNG）、命名规则、质量控制 | 图片保存与导出功能                                      |
| **阶段 7**  | 图片水印（高级）            | 支持导入本地图片作为水印（如 Logo），支持透明 PNG      | 图片水印合成逻辑                                        |
| **阶段 8**  | 模板系统                    | 保存/加载水印配置（如 JSON），支持自定义模板管理       | 模板序列化与 UI 管理                                    |
| **阶段 9**  | 打包与发布                  | 将应用打包为 Windows 可执行程序（EXE/MSI）             | 可分发安装包                                            |
| **阶段 10** | 优化与迭代                  | 性能优化、错误处理、用户交互改进                       | 更稳定的正式版                                          |

> 📌 **每个阶段完成后，你应该使用 Git 提交代码，并按 Conventional Commits 规范书写清晰的提交信息。**

## 🎯 项目目标

开发一个 Java 桌面应用，具备以下核心功能：

1. 文件处理

	1.1导入图片

		支持单张图片拖拽或通过文件选择器导入。

		支持批量导入，可一次性选择多张图片或直接导入整个文件夹。

		在界面上显示已导入图片的列表（缩略图和文件名）。



	1.2支持格式

		输入格式：必须支持主流格式，如 JPEG, PNG。强烈建议支持 BMP, TIFF。PNG格式必须支持透明通道。

		输出格式：用户可选择输出为 JPEG 或 PNG。


	1.3导出图片

		用户可指定一个输出文件夹。为防止覆盖原图，默认禁止导出到原文件夹。

		提供导出文件命名规则选项：

			保留原文件名。

			添加自定义前缀（如 wm_）。

			添加自定义后缀（如 _watermarked）。

		对于 JPEG 格式，提供图片质量（压缩率）调节滑块（0-100）。（可选高级功能）

		导出时允许用户调整图片尺寸（如按宽度、高度或百分比缩放）。（可选高级功能）


2. 水印类型

	2.1文本水印

		内容：用户可自定义输入任意文本。

		字体：可选择系统已安装的字体、字号、粗体、斜体。（可选高级功能）

		颜色：提供调色板让用户选择字体颜色。（可选高级功能）

		透明度：可调节文本的透明度（0-100%）。

		样式：可添加阴影或描边效果，以增强在复杂背景下的可读性。（可选高级功能）

	2.2图片水印（可选高级功能）

		用户可从本地选择一张图片（如Logo）作为水印。

		必须支持带透明通道的 PNG 图片。

		缩放：可按比例或自由调整图片水印的大小。

		透明度：可调节图片水印的整体透明度（0-100%）。


3. 水印布局与样式

	3.1实时预览：所有对水印的调整都应在主预览窗口中实时显示效果。用户可以点击图片列表切换预览不同的图片。

	3.2位置

			预设位置：提供九宫格布局（四角、正中心），用户可一键将水印放置在这些位置。

			手动拖拽：用户可以直接在预览图上通过鼠标拖拽水印到任意位置。

	3.3旋转：提供一个滑块或输入框，允许用户以任意角度旋转水印。（可选高级功能）


4. 配置管理

4.1 水印模板：

		用户可以将当前的水印设置（包括水印内容、字体、颜色、位置、大小、透明度等所有参数）保存为一个模板。

		用户可以加载、管理和删除已保存的模板。

		程序启动时可自动加载上一次关闭时的设置或一个默认模板。

------

## ✅ 开发流程总纲（分阶段）

| 阶段        | 目标                 | 关键任务                                          |
| :---------- | :------------------- | :------------------------------------------------ |
| **阶段 1**  | 环境与工具准备       | 安装 JDK、Maven、IDE，创建项目，引入 JavaFX/Swing |
| **阶段 2**  | 项目初始化与架构设计 | 搭建 Maven 项目结构，定义模块与交互流程           |
| **阶段 3**  | 图片导入模块         | 支持单张/多张/文件夹导入，显示图片列表            |
| **阶段 4**  | 文本水印核心功能     | 实现水印文字绘制（字体、颜色、透明度、位置）      |
| **阶段 5**  | 水印布局与交互       | 支持九宫格位置 / 拖拽 / 旋转 / 实时预览           |
| **阶段 6**  | 图片导出模块         | 支持导出路径、格式、命名规则、质量控制            |
| **阶段 7**  | 图片水印（高级）     | 支持加载本地透明 PNG 作为水印，调整大小/透明度    |
| **阶段 8**  | 模板系统             | 保存/加载水印配置（JSON），支持模板管理 UI        |
| **阶段 9**  | 打包与发布           | 使用 jpackage 打包为 Windows 应用程序             |
| **阶段 10** | 优化与迭代           | 性能优化、错误处理、交互改进                      |

------

## 🔧 阶段 1：环境与工具准备

### 任务 1.1：确认开发环境

- 安装 **JDK 17（推荐 LTS）**
- 安装 **Maven**（或 Gradle）
- 安装代码编辑器（如 IntelliJ IDEA、VS Code、Eclipse）
- 验证：`java -version`、`javac -version`、`mvn -v`

### 任务 1.2：创建 Maven 项目

- 使用命令：

  ```
  mvn archetype:generate -DgroupId=com.mywatermark -DartifactId=image-watermarker -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false
  ```

- 或使用 IDE 创建标准 Maven 项目

### 任务 1.3：选择 GUI 框架

- 推荐：**JavaFX**（现代、强大，支持图片与 UI 动画）
- 备选：**Swing**（无需额外依赖，但 UI 较传统）
- 引入相关依赖（JavaFX 需单独配置，或使用模块化 JDK）


------

## 🗂️ 阶段 2：项目架构设计与模块划分

### 任务 2.1：定义功能模块

- 图片导入模块
- 水印处理模块（文本/图片）
- 水印布局与预览模块
- 图片导出模块
- 模板管理模块
- 打包模块

### 任务 2.2：设计主流程

- 用户导入图片 → 选择水印内容/样式 → 调整参数 → 预览 → 导出


------

## 🖼️ 阶段 3：图片导入模块

### 任务 3.1：支持单张/多张图片导入

- 使用 `JFileChooser`（Swing）或 `FileChooser`（JavaFX）

### 任务 3.2：支持文件夹批量导入

- 获取所有图片文件，过滤格式

### 任务 3.3：图片列表展示

- 显示缩略图 + 文件名（JavaFX: `ImageView`，Swing: `JLabel + ImageIcon`）


------

## ✏️ 阶段 4：文本水印核心功能

### 任务 4.1：图片加载

- 使用 `ImageIO.read(File)`加载图片为 `BufferedImage`

### 任务 4.2：绘制文本水印

- 使用 `Graphics2D`，设置字体、颜色、透明度（Alpha）、坐标

### 任务 4.3：导出图片

- 使用 `ImageIO.write(...)`输出到新文件


------

## 🎛️ 阶段 5：水印布局与交互

### 任务 5.1：支持九宫格预设位置

- 左上、中上、右上、左中、居中、右中、左下、中下、右下

### 任务 5.2：支持拖拽或参数化位置调整

- 通过 UI 或参数设置 X/Y 坐标

### 任务 5.3：支持旋转（角度）、透明度等


------

## 💾 阶段 6：图片导出模块

### 任务 6.1：选择输出目录

- 不允许导出到原图目录（可提示）

### 任务 6.2：支持自定义文件命名

- 原文件名 / 前缀（如 wm_） / 后缀（如 _watermarked）

### 任务 6.3：支持格式选择与质量控制

- JPEG（可调质量）、PNG（支持透明）


------

## 🖼️ 阶段 7：图片水印（高级功能）

### 任务 7.1：加载本地图片作为水印（如 Logo）

- 支持透明 PNG

### 任务 7.2：支持缩放与透明度调整


------

## 🧩 阶段 8：模板系统

### 任务 8.1：保存水印配置为 JSON

- 包括：文字内容、字体、颜色、位置、透明度、旋转等

### 任务 8.2：提供模板管理 UI

- 保存 / 加载 / 删除模板

------

## 📦 阶段 9：打包与发布

### 任务 9.1：使用 `jpackage`打包

- 生成 Windows 可执行程序（.exe 或安装包）

------

## 🔧 阶段 10：优化与迭代

- 性能优化（批量处理、异步）
- 错误处理与用户提示
- 日志记录
- UI 美化与交互提升
